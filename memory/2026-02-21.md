# 2026-02-21

## GeoReview лидогенерация — большой прогресс

### 2GIS парсер v4 — рабочий!
- `parse_2gis_v4.js` на сервере `/tmp/parse_2gis_v4.js` — универсальный парсер
- Перехватывает внутренний API через `page.on('response')`, кликает из поиска (не прямой URL — антибот)
- Внутренний API ключ: `c7f1a769-c8a5-4636-b14d-d8c987808a12`
- Работает для любого запроса: `node parse_2gis_v4.js "стоматология" "Москва"`
- Рестарт браузера между страницами (OOM на 960MB RAM)

### Результаты парсинга
- **49 автосервисов Сочи** из 2GIS (35 с сайтами, 17 с email, 49 с телефонами)
- Отфильтровано Python: убраны нерелевантные (обувь, запчасти) → **47 уникальных лидов**
- Данные: `/Users/karavan/Developer/walloflove/leads/sochi_autoservice_2gis_full.json`

### Google Sheet
- ID: `1iXyCnAguSJmfGu0fFvofvHVxzIcYyQJXxdV9ys0Qyo0`, лист "Лист1"
- Сейчас ~56 лидов (36 стомат + 20 авто)
- **47 новых лидов готовы к загрузке** (IDs 60-106, отформатированы)
- Приоритеты: 24 HIGH (50+ отзывов), остальные MEDIUM/LOW

### Скрипты на сервере 89.169.2.143
- `/tmp/parse_2gis_v4.js` — рабочий парсер (ГЛАВНЫЙ)
- `/tmp/parse_2gis_full.js` (v1), `/tmp/sniff_2gis.js` (debug), `/tmp/enrich_2gis.js` (заблокирован API)
- Нужно скопировать v4 в репо `lib/scrapers/`

### Следующие шаги
1. Загрузить 47 лидов в Google Sheet
2. Скопировать parse_2gis_v4.js в проект
3. Проверить сайты автосервисов на виджеты отзывов
4. Парсить другие города/ниши: Краснодар, косметология, частная медицина
5. Починить extract_contacts.js (хардкодит результаты denta-luxik)
6. Начать рассылку — шаблоны email и скрипты звонков

### Технические находки
- 2GIS > Яндекс > Yell по качеству данных
- Яндекс Карты полностью заблокированы для парсинга
- Yell.ru слабый (~20% с сайтами)
- Сервер: 3GB swap, Node v20.20.0, Playwright+Chromium установлены
- С мака парсить нельзя (VPN блокирует рос. сервисы)
